<Window
    x:Class="ExcelDna_MVVM.GUI.wdwpfOverlayDialog"
    xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
    xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
    Title="OverlayDialog"
    Width="300"
    Height="400"
    AllowsTransparency="True"
    Background="Transparent"
    BorderBrush="Transparent"
    BorderThickness="0"
    ResizeMode="NoResize"
    ShowActivated="True"
    ShowInTaskbar="False"
    WindowStartupLocation="Manual"
    WindowStyle="None">
    <Canvas x:Name="Canvas">
        <Rectangle
            Name="GrayRectangle"
            Width="{Binding RelativeSource={RelativeSource AncestorType={x:Type Border}}, Path=ActualWidth}"
            Height="{Binding RelativeSource={RelativeSource AncestorType={x:Type Border}}, Path=ActualHeight}"
            Fill="LightGray"
            IsHitTestVisible="True"
            Opacity="0.01">
            <!--  Override Opacity in Constructor to be shure the Relase Version are always invisible  -->
            <Rectangle.InputBindings>
                <MouseBinding Command="{Binding OutsideAreaClick}" MouseAction="LeftClick" />
            </Rectangle.InputBindings>
        </Rectangle>

    </Canvas>
</Window>
